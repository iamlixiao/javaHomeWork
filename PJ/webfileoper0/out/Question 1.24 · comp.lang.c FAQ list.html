<!DOCTYPE HTML PUBLIC "-//W3O//DTD W3 HTML 2.0//EN"><!-- This collection of hypertext pages is Copyright 1995-2005 by Steve Summit. --><!-- Content from the book "C Programming FAQs: Frequently Asked Questions" --><!-- (Addison-Wesley, 1995, ISBN 0-201-84519-9) is made available here by --><!-- permission of the author and the publisher as a service to the community. --><!-- It is intended to complement the use of the published text --><!-- and is protected by international copyright laws. --><!-- The on-line content may be accessed freely for personal use --><!-- but may not be published or retransmitted without explicit permission. --><!-- --><!-- this page built Sat Dec 24 21:47:45 2005 by faqproc version 2.7 --><!-- from source file decl.sgml dated Wed Dec 21 12:56:18 2005 --><!-- corresponding to FAQ list version 4.0 --><html><head><meta name=GENERATOR content="faqproc"><title>Question 1.24</title><link href="dynarray.html" rev=precedes><link href="implfdecl.html" rel=precedes><link href="index.html" rev=subdocument></head><body bgcolor="#ffffff"><p><!-- qbegin --><p><font face=Helvetica size=8 color=blue><b>Q:</b></font>I have an <TT>extern</TT> arraywhich is definedinone file,and used in another:<pre><I>file1.c:</I>			<I>file2.c:</I>int array[] = {1, 2, 3};	extern int array[];</pre>Why doesn't <TT>sizeof</TT> work on<TT>array</TT> in <TT>file2.c</TT>?</p><p><hr><p><font face=Helvetica size=8 color=blue><b>A:</b></font>An <TT>extern</TT> array of unspecified sizeis an incomplete type; you cannot apply <TT>sizeof</TT> to it.<TT>sizeof</TT> operates at compile time,andthere is no way for it to learn the size of anarraywhich is defined in another file.</p><p>You have three options:<OL><li>Declare a companion variable,containing the size of the array,defined and initialized (with <TT>sizeof</TT>)in the same source file where the array is defined:<pre><I>file1.c:</I>			<I>file2.c:</I>int array[] = {1, 2, 3};	extern int array[];int arraysz = sizeof(array);	extern int arraysz;</pre>(See also question <a href="../aryptr/arraynels.html">6.23</a>.)<li><TT>#define</TT> a manifest constantfor the sizesothatit can be used consistently in the definitionand the <TT>extern</TT> declaration:<pre><I>file1.h:</I>#define ARRAYSZ 3extern int array[ARRAYSZ];<I>file1.c:</I>			<I>file2.c:</I>#include "file1.h"		#include "file1.h"int array[ARRAYSZ];</pre><li>Usesome sentinel value(typically <TT>0</TT>, <TT>-1</TT>, or <TT>NULL</TT>)inthe array's last element,sothat code can determine the endwithout an explicit size indication:<pre><I>file1.c:</I>			<I>file2.c:</I>int array[] = {1, 2, 3, -1};	extern int array[];</pre></OL>(Obviously,the choice will depend to some extenton whether the array was already being initialized;if it was,option 2 is poor.)</p><p>See also question<a href="../aryptr/aryparmsize.html">6.21</a>.</p><p>References:H&amp;S Sec. 7.5.2 p. 195<br></p><!-- aend --><p><hr>